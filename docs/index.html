<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PixOrder - Smart Media File Organizer for macOS</title>
    <meta name="description" content="Automatically organize your photos and videos by aspect ratio. Smart classification, multi-format support, and real-time progress tracking.">
    <meta name="keywords" content="macOS, photo organizer, video organizer, aspect ratio, media management, Swift, SwiftUI">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="128x128" href="icon-128.png">
    <link rel="icon" type="image/png" sizes="256x256" href="icon-256.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
    <link rel="apple-touch-icon" href="icon-256.png">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://jiminycricket.github.io/PixOrder/">
    <meta property="og:title" content="PixOrder - Smart Media File Organizer for macOS">
    <meta property="og:description" content="Automatically organize your photos and videos by aspect ratio">
    <meta property="og:image" content="https://jiminycricket.github.io/PixOrder/icon-512.png">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://jiminycricket.github.io/PixOrder/">
    <meta property="twitter:title" content="PixOrder - Smart Media File Organizer for macOS">
    <meta property="twitter:description" content="Automatically organize your photos and videos by aspect ratio">
    <meta property="twitter:image" content="https://jiminycricket.github.io/PixOrder/icon-512.png">
    
    <style>
        :root {
            --primary-color: #3C493F;
            --secondary-color: #7E8D85;
            --tertiary-color: #B3BFB8;
            --background-color: #F0F7F4;
            --accent-color: #A2E3C4;
            --text-light: #ffffff;
            --text-dark: #333333;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            --shadow-hover: 0 8px 30px rgba(0, 0, 0, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-weight: 200;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background: linear-gradient(135deg, var(--background-color) 0%, var(--accent-color) 100%);
            min-height: 100vh;
            font-weight: 200;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header */
        header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow);
        }
        
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }
        
        .logo {
            display: flex;
            align-items: center;
            font-size: 1.25rem;
            font-weight: 100;
            color: var(--primary-color);
            text-decoration: none;
            padding: 0.5rem 0;
        }
        
        .logo img {
            width: 30px;
            height: 30px;
            margin-right: 12px;
        }
        
        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
        }
        
        .nav-links a {
            text-decoration: none;
            color: var(--primary-color);
            font-weight: 200;
            transition: color 0.3s ease;
        }
        
        .nav-links a:hover {
            color: var(--secondary-color);
        }
        
        /* Hero Section */
        .hero {
            text-align: center;
            padding: 2rem 0;
            margin: 2rem 0 0 0;
        }
        
        .hero-icon {
            margin-bottom: 2rem;
        }
        
        .hero-icon img {
            width: 120px;
            height: 120px;
            transition: transform 0.3s ease;
        }
        
        .hero-icon img:hover {
            transform: translateY(-5px);
        }
        
        .hero h1 {
            font-size: 3rem;
            font-weight: 100;
            color: var(--primary-color);
            margin-bottom: 1rem;
            line-height: 1.2;
        }
        
        .hero p {
            font-size: 1.3rem;
            color: var(--secondary-color);
            font-weight: 200;
            margin-bottom: 2rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .cta-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 2rem;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            padding: 12px 24px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 200;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: var(--text-light);
            box-shadow: var(--shadow);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
            background: #2a3530;
        }
        
        .btn-secondary {
            background: transparent;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }
        
        .btn-secondary:hover {
            background: var(--primary-color);
            color: var(--text-light);
            transform: translateY(-2px);
        }
        
        /* Features Section */
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2rem;
            padding: 2rem 0;
        }
        
        .feature {
            background: rgba(255, 255, 255, 0.9);
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: var(--shadow);
        }
        
        .feature:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-hover);
        }
        
        .feature-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .feature h3 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }
        
        .feature p {
            color: var(--secondary-color);
            line-height: 1.6;
        }
        
        /* Download Section */
        .download-section {
            background: rgba(255, 255, 255, 0.95);
            padding: 3rem;
            border-radius: 20px;
            text-align: center;
            margin: 3rem 0;
            backdrop-filter: blur(20px);
            box-shadow: var(--shadow);
        }
        
        .download-section h2 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-size: 2.5rem;
            font-weight: 100;
        }
        
        .download-section p {
            color: var(--secondary-color);
            margin-bottom: 2rem;
            font-size: 1.1rem;
        }
        
        .download-options {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 2rem;
        }
        
        .download-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 1.5rem 2rem;
            background: var(--primary-color);
            color: var(--text-light);
            text-decoration: none;
            border-radius: 12px;
            transition: all 0.3s ease;
            min-width: 220px;
            box-shadow: var(--shadow);
        }
        
        .download-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-hover);
            background: #2a3530;
        }
        
        .download-btn .icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        
        .download-btn .title {
            font-weight: 100;
            margin-bottom: 0.25rem;
            font-size: 1.1rem;
        }
        
        .download-btn .subtitle {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        /* System Requirements */
        .system-requirements {
            padding: 2rem;
        }
        
        .system-requirements h3 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }
        
        .requirements-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            color: var(--secondary-color);
            list-style: none;
        }
        
        .requirements-list li {
            display: flex;
            align-items: center;
        }
        
        .requirements-list li::before {
            content: "✅";
            margin-right: 10px;
            font-size: 1.1rem;
        }
        
        /* Footer */
        footer {
            background: rgba(60, 73, 63, 0.95);
            color: var(--text-light);
            text-align: center;
            padding: 3rem 0;
            margin-top: 4rem;
            backdrop-filter: blur(20px);
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        
        .footer-links a {
            color: var(--text-light);
            text-decoration: none;
            opacity: 0.8;
            transition: opacity 0.3s ease;
        }
        
        .footer-links a:hover {
            opacity: 1;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2.5rem;
            }
            
            .nav-links {
                display: none;
            }
            
            .cta-buttons, .download-options {
                flex-direction: column;
                align-items: center;
            }
            
            .download-btn {
                width: 100%;
                max-width: 300px;
            }
            
            .hero-icon img {
                width: 100px;
                height: 100px;
            }
        }
        
        /* Loading animation */
        .loading {
            opacity: 0.5;
            pointer-events: none;
        }
        
        /* Success animation */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .download-success {
            animation: pulse 0.3s ease-in-out;
        }
    </style>
</head>
<body>
    <header>
        <nav class="container">
            <a href="#" class="logo">
                <img src="icon-128.png" alt="PixOrder Icon">
                PixOrder
            </a>
            <ul class="nav-links">
                <li><a href="#features">Features</a></li>
                <li><a href="#download">Download</a></li>
                <li><a href="https://github.com/jiminycricket/PixOrder">GitHub</a></li>
            </ul>
        </nav>
    </header>
    
    <main class="container">
        <section class="hero">
            <div class="hero-icon">
                <img src="icon-256.png" alt="PixOrder App Icon">
            </div>
            <h1>Smart Media File Organizer</h1>
            <p>Automatically organize your photos and videos by aspect ratio. Clean, fast, and intelligent file management for macOS.</p>
            
            <div class="cta-buttons">
                <a href="#" id="hero-download" class="btn btn-primary">
                    Download
                </a>
            </div>
        </section>
        
        <section id="features" class="features">
            <div class="feature">
                <div class="feature-icon">🎯</div>
                <h3>Smart Classification</h3>
                <p>Automatically detects and organizes files by aspect ratios: square (1:1), landscape (16:9, 4:3), and portrait (9:16, 3:4).</p>
            </div>
            
            <div class="feature">
                <div class="feature-icon">📱</div>
                <h3>Multi-Format Support</h3>
                <p>Supports all major formats including JPEG, PNG, HEIF, MOV, MP4, and more. Perfect for iPhone photos and videos.</p>
            </div>
            
            <div class="feature">
                <div class="feature-icon">🔄</div>
                <h3>Safe Operations</h3>
                <p>Choose between copy or move modes. Built-in conflict resolution ensures no files are lost or overwritten.</p>
            </div>
            
            <div class="feature">
                <div class="feature-icon">📊</div>
                <h3>Real-time Progress</h3>
                <p>Live progress tracking with detailed logs. Pause, resume, or cancel operations at any time with full control.</p>
            </div>
            
            <div class="feature">
                <div class="feature-icon">🎨</div>
                <h3>Modern Interface</h3>
                <p>Beautiful dark theme interface built with SwiftUI. Native macOS experience with intuitive controls and smooth animations.</p>
            </div>
            
            <div class="feature">
                <div class="feature-icon">🛡️</div>
                <h3>Privacy Focused</h3>
                <p>App Sandbox security enabled. All processing happens locally on your Mac. No data is sent anywhere, ever.</p>
            </div>
        </section>
        
        <section id="download" class="download-section">
            <h2>Download PixOrder</h2>
            <p>Free and open source. Compatible with Apple Silicon and Intel Macs.</p>
            <p id="version-info" style="font-weight: 100; color: var(--primary-color);">Loading latest version...</p>
            
            <div class="download-options">
                <a href="#" id="dmg-download" class="download-btn">
                    <div class="icon">💿</div>
                    <div class="title">DMG Installer</div>
                    <div class="subtitle">Recommended for most users</div>
                </a>
                
                <a href="#" id="zip-download" class="download-btn">
                    <div class="icon">📦</div>
                    <div class="title">ZIP Archive</div>
                    <div class="subtitle">Alternative download</div>
                </a>
            </div>
            
            <div class="system-requirements">
                <h3>System Requirements</h3>
                <ul class="requirements-list">
                    <li>macOS 13.0 or later</li>
                    <li>Apple Silicon (M1/M2/M3) or Intel processor</li>
                    <li>50 MB free disk space</li>
                    <li>Admin privileges for installation</li>
                </ul>
            </div>
        </section>
    </main>
    
    <footer>
        <div class="container">
            <div class="footer-links">
                <a href="https://github.com/jiminycricket/PixOrder">GitHub</a>
                <a href="https://github.com/jiminycricket/PixOrder/releases">Releases</a>
                <a href="https://github.com/jiminycricket/PixOrder/issues">Support</a>
                <a href="https://github.com/jiminycricket/PixOrder/blob/main/LICENSE">License</a>
            </div>
            <p>&copy; 2025 PixOrder. Open source under MIT License.</p>
        </div>
    </footer>
    
    <script>
        // Configuration
        const GITHUB_USER = 'jiminycricket';
        const REPO_NAME = 'PixOrder';
        
        // Fetch latest release info and update download links
        async function updateDownloadLinks() {
            const MAX_RETRIES = 3;
            let retryCount = 0;
            
            async function attemptUpdate() {
                try {
                    // Check if document is ready
                    if (document.readyState !== 'complete' && document.readyState !== 'interactive') {
                        setTimeout(updateDownloadLinks, 500);
                        return;
                    }
                    
                    // Check if elements exist before proceeding
                    const versionInfo = document.getElementById('version-info');
                    const dmgLink = document.getElementById('dmg-download');
                    const zipLink = document.getElementById('zip-download');
                    const heroDownload = document.getElementById('hero-download');
                    
                    if (!versionInfo || !dmgLink || !zipLink || !heroDownload) {
                        if (retryCount < MAX_RETRIES) {
                            retryCount++;
                            setTimeout(attemptUpdate, 1000);
                            return;
                        } else {
                            console.warn('Elements not found after maximum retries, using fallback');
                            handleDownloadLinkError();
                            return;
                        }
                    }
                    
                    
                    // Add timeout to fetch request
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 10000); // 10 second timeout
                    
                    const response = await fetch(`https://api.github.com/repos/${GITHUB_USER}/${REPO_NAME}/releases/latest`, {
                        signal: controller.signal,
                        headers: {
                            'Accept': 'application/vnd.github.v3+json',
                            'User-Agent': 'PixOrder-Website'
                        }
                    });
                    
                    clearTimeout(timeoutId);
                    
                    if (!response.ok) {
                        throw new Error(`GitHub API error: ${response.status} ${response.statusText}`);
                    }
                    
                    const release = await response.json();
                    
                    if (!release || !release.tag_name) {
                        throw new Error('Invalid release data received from GitHub API');
                    }
                    
                    const version = release.tag_name;
                    
                    // Update version info safely
                    if (versionInfo) {
                        versionInfo.textContent = `Latest Version: ${version}`;
                    }
                    
                    // Find DMG and ZIP assets
                    const assets = Array.isArray(release.assets) ? release.assets : [];
                    const dmgAsset = assets.find(asset => 
                        asset && asset.name && asset.name.toLowerCase().includes('.dmg')
                    );
                    const zipAsset = assets.find(asset => 
                        asset && asset.name && asset.name.toLowerCase().includes('.zip')
                    );
                    
                    // Update download links with safe attribute setting
                    if (dmgAsset && dmgAsset.browser_download_url) {
                        if (dmgLink) {
                            dmgLink.href = dmgAsset.browser_download_url;
                            dmgLink.onclick = (e) => trackDownload('DMG', version, e);
                        }
                        
                        // Update hero download button to direct download DMG
                        if (heroDownload) {
                            heroDownload.href = dmgAsset.browser_download_url;
                            heroDownload.onclick = (e) => trackDownload('DMG-Hero', version, e);
                        }
                        
                    } else {
                        console.warn('No valid DMG asset found in release');
                    }
                    
                    if (zipAsset && zipAsset.browser_download_url) {
                        if (zipLink) {
                            zipLink.href = zipAsset.browser_download_url;
                            zipLink.onclick = (e) => trackDownload('ZIP', version, e);
                        }
                        
                    } else {
                        console.warn('No valid ZIP asset found in release');
                    }
                    
                } catch (error) {
                    if (error.name === 'AbortError') {
                        console.error('GitHub API request timed out');
                    } else {
                        console.error('Failed to fetch release info:', error);
                    }
                    handleDownloadLinkError();
                }
            }
            
            await attemptUpdate();
        }
        
        // Handle download link errors with safe fallbacks
        function handleDownloadLinkError() {
            const elements = {
                'version-info': 'Visit GitHub for latest version',
                'dmg-download': `https://github.com/${GITHUB_USER}/${REPO_NAME}/releases/latest`,
                'zip-download': `https://github.com/${GITHUB_USER}/${REPO_NAME}/releases/latest`,
                'hero-download': `https://github.com/${GITHUB_USER}/${REPO_NAME}/releases/latest`
            };
            
            Object.entries(elements).forEach(([id, fallback]) => {
                const element = document.getElementById(id);
                if (element) {
                    if (id === 'version-info') {
                        element.textContent = fallback;
                    } else {
                        element.href = fallback;
                        element.onclick = null; // Remove onclick handlers
                    }
                }
            });
            
        }
        
        // Track downloads with safe event handling
        function trackDownload(type, version, event) {
            try {
                // Add visual feedback safely
                if (event && event.currentTarget) {
                    const btn = event.currentTarget;
                    if (btn && typeof btn.classList !== 'undefined') {
                        btn.classList.add('download-success');
                        setTimeout(() => {
                            if (btn && btn.classList) {
                                btn.classList.remove('download-success');
                            }
                        }, 300);
                    }
                }
                
                // Analytics (if needed)
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'download', {
                        'event_category': 'engagement',
                        'event_label': `${type}-${version}`,
                        'version': version
                    });
                }
                
                // Log download with user-friendly messages
                const downloadType = type.includes('Hero') ? 'Hero Button DMG' : type;
                
                // Optional: Show a brief success message
                if (type.includes('Hero')) {
                    // You could add a toast notification here if desired
                }
                
            } catch (error) {
                console.error('Error tracking download:', error);
            }
        }
        
        // Smooth scrolling for anchor links with safe querySelector
        function initializeSmoothScrolling() {
            try {
                const anchorLinks = document.querySelectorAll('a[href^="#"]');
                if (anchorLinks.length === 0) {
                    return;
                }
                
                anchorLinks.forEach(anchor => {
                    if (anchor && typeof anchor.addEventListener === 'function') {
                        anchor.addEventListener('click', function (e) {
                            try {
                                const href = this.getAttribute('href');
                                if (!href || href === '#') return;
                                
                                // Only handle hash-based internal links, not full URLs
                                if (!href.startsWith('#')) {
                                    return; // Let the browser handle external/absolute links normally
                                }
                                
                                e.preventDefault();
                                
                                // Validate that the href is a valid CSS selector
                                try {
                                    const target = document.querySelector(href);
                                    if (target && typeof target.scrollIntoView === 'function') {
                                        target.scrollIntoView({
                                            behavior: 'smooth',
                                            block: 'start'
                                        });
                                    } else {
                                        console.warn(`Target element not found for href: ${href}`);
                                    }
                                } catch (selectorError) {
                                    console.warn(`Invalid CSS selector: ${href}`, selectorError);
                                }
                                
                            } catch (scrollError) {
                                console.error('Error in smooth scroll handler:', scrollError);
                            }
                        });
                    }
                });                
            } catch (error) {
                console.error('Error initializing smooth scrolling:', error);
            }
        }
        
        // Safe initialization with multiple fallbacks
        function initializeWebsite() {
            try {
                
                // Initialize smooth scrolling
                initializeSmoothScrolling();
                
                // Update download links
                updateDownloadLinks();
                
                // Set up periodic updates
                setInterval(() => {
                    try {
                        updateDownloadLinks();
                    } catch (error) {
                        console.error('Error in periodic update:', error);
                    }
                }, 5 * 60 * 1000); // 5 minutes
                                
            } catch (error) {
                console.error('Error during website initialization:', error);
            }
        }
        
        // Multiple initialization strategies
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeWebsite);
        } else {
            initializeWebsite();
        }
        
        // Fallback initialization
        window.addEventListener('load', function() {
            setTimeout(initializeWebsite, 100);
        });
        
        // Add loading states with safe element handling
        function setLoadingState(isLoading) {
            try {
                const downloadButtons = document.querySelectorAll('.download-btn');
                if (!downloadButtons || downloadButtons.length === 0) {
                    return;
                }
                
                downloadButtons.forEach(btn => {
                    if (btn && typeof btn.classList !== 'undefined') {
                        if (isLoading) {
                            btn.classList.add('loading');
                        } else {
                            btn.classList.remove('loading');
                        }
                    }
                });
                
            } catch (error) {
                console.error('Error setting loading state:', error);
            }
        }
    </script>
</body>
</html>